{% extends 'base.html' %}
{% block body %}

<!-- ใช้ container แบบ local เฉพาะในหน้านี้ -->
<div style="max-width: 800px; margin: auto; padding: 2em;">

  <!-- ปุ่มสร้าง -->
  <div class="text-center mb-4">
    <a class="btn btn-primary btn-lg" href="{{ url_for('notes_create') }}">Create New Note</a>
  </div>

  {% for note in notes %}
  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <h4 class="card-title">{{ note.title }}</h4>
      <small class="text-muted">Created: {{ note.created_date.strftime('%Y-%m-%d %H:%M') }}</small>

      <p class="card-text mt-3">{{ note.description }}</p>

      <!-- ปุ่มแก้ไข / ลบ -->
      <div class="mt-3">
        <a href="{{ url_for('notes_edit', note_id=note.id) }}" class="btn btn-sm btn-outline-warning">Edit Note</a>

        <form action="{{ url_for('notes_delete', note_id=note.id) }}" method="POST" style="display:inline;"
          onsubmit="return confirm('Delete this note?');">
          <button type="submit" class="btn btn-sm btn-outline-danger">Delete Note</button>
        </form>
      </div>
    </div>

    <div class="card-footer bg-light text-muted">
      Tags:
      {% if note.tags %}
      {% for t in note.tags %}
      <span class="badge bg-success me-1 fs-6">{{ t.name }}</span>
      {% endfor %}
      {% else %}
      <span class="text-muted">No tags</span>
      {% endif %}
      <br>
      Last updated: {{ note.updated_date.strftime('%Y-%m-%d %H:%M') }}
      {% for t in note.tags %}
      <form method="GET" action="{{ url_for('tags_view', tag_name=t.name) }}" style="display:inline;">
        <button type="submit" class="btn btn-sm btn-outline-success">View Tag</button>
      </form>
      {% else %}
      <span class="text-muted">No tags</span>
      {% endfor %}

    </div>

  </div>
  {% endfor %}
</div>

{% endblock %}